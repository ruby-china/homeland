<script src="//ruby-china-files.b0.upaiyun.com/assets/d3.min.js" data-turbolinks-track type="text/javascript"></script>
<script src="//ruby-china-files.b0.upaiyun.com/assets/cal-heatmap.min.js" data-turbolinks-track type="text/javascript"></script>

<div class="panel panel-default userinfo">
  <div class="panel-body">
    <div id="cal-heatmap" class="user-activity-graph"></div>
    <%
    start_date = 12.months.ago.beginning_of_month
    %>
    <script type="text/javascript">
      var cal = new CalHeatMap();
      cal.init({
        itemSelector: "#cal-heatmap",
        animationDuration: 200,
        domain: "month",
        subDomain: 'day',
        rowLimit: 7,
        domainGutter: 0,
        data: '<%= calendar_user_path(@user, format: 'json') %>',
        start: new Date(<%= start_date.year %>, <%= start_date.month %>, <%= start_date.day %>),
        legendHorizontalPosition: 'right',
        legendColors: ["#E2FBAE", "#01840E"],
        // subDomainTextFormat: "%d",
        domainLabelFormat: "%b",
        legend: [1, 5, 10, 15],
        itemName: ['event', 'events'],
        highlight: 'now',
        label: {
          position: 'top'
        },
        displayLegend: true
      });
    </script>
  </div>
</div>
